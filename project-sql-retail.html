<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retail Sales SQL Data Load | Anurag Meshram</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/sql-wasm.js"></script>
</head>
<body>

  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="nav-logo">Anurag <span>Meshram</span></a>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="experience.html">Experience</a></li>
        <li class="nav-dropdown">
          <a href="#">EDA</a>
          <div class="nav-dropdown-menu">
            <a href="project-eda-ecommerce.html">E-Commerce</a>
            <a href="project-eda-retail.html">Retail Sales</a>
          </div>
        </li>
        <li class="nav-dropdown">
          <a href="#">SQL Data Load</a>
          <div class="nav-dropdown-menu">
            <a href="project-sql-ecommerce.html">E-Commerce</a>
            <a href="project-sql-retail.html">Retail Sales</a>
          </div>
        </li>
        <li class="nav-dropdown">
          <a href="#">DB Schema</a>
          <div class="nav-dropdown-menu">
            <a href="project-schema-ecommerce.html">E-Commerce</a>
            <a href="project-schema-retail.html">Retail Sales</a>
          </div>
        </li>
        <li><a href="project-powerbi.html">Power BI</a></li>
        <li class="nav-dropdown">
          <a href="#">Web Scraper</a>
          <div class="nav-dropdown-menu">
            <a href="project-scraper-odp.html">Office Depot (ODP)</a>
            <a href="project-scraper-staples.html">Staples</a>
          </div>
        </li>
        <li class="nav-dropdown">
          <a href="#">AI / Chatbot</a>
          <div class="nav-dropdown-menu">
            <a href="project-chatbot.html">Product Substitution</a>
          </div>
        </li>
        <li><a href="assets/resume/Anurag_Meshram_Resume.pdf" class="nav-resume-btn" download>&#11015; Resume</a></li>
      </ul>
      <button class="hamburger" aria-label="Toggle navigation"><span></span><span></span><span></span></button>
    </div>
  </nav>

  <div class="page-content">

    <section class="project-hero">
      <div class="container">
        <div class="project-hero-content fade-in">
          <div class="breadcrumb">
            <a href="index.html">Home</a><span class="separator">/</span><span>Retail Sales SQL Data Load</span>
          </div>
          <h1 class="project-title">Retail Sales SQL Data Load &amp; ETL Pipeline</h1>
          <div class="project-meta">
            <span class="meta-item"><span class="meta-icon">&#128451;</span> ETL Pipeline</span>
            <span class="meta-item"><span class="meta-icon">&#128196;</span> Excel &rarr; MySQL</span>
            <span class="meta-item"><span class="meta-icon">&#128295;</span> Python, MySQL, Pandas</span>
          </div>
          <div class="card-tags">
            <span class="tag">Python</span><span class="tag green">Pandas</span>
            <span class="tag orange">MySQL</span><span class="tag cyan">ETL</span>
            <span class="tag blue">Automation</span><span class="tag">62K Rows</span>
          </div>
          <div class="project-actions">
            <a href="src/retail_sales_load.py" class="btn btn-sm btn-outline" download>&#11015; Download retail_sales_load.py</a>
            <a href="src/retail_sales_schema.md" class="btn btn-sm btn-outline" download>&#11015; Schema Docs</a>
          </div>
        </div>
      </div>
    </section>

    <div class="container">

      <div class="content-section fade-in">
        <h2>Project Overview</h2>
        <p>Automated ETL pipeline that reads denormalized retail sales data (62,884 transaction line items) from Excel, normalizes it into 7 relational tables following 3NF with a product category hierarchy, and loads it into MySQL on localhost:3307.</p>
        <div class="info-grid">
          <div class="info-card"><div class="value">1</div><div class="label">Source Table</div></div>
          <div class="info-card"><div class="value">7</div><div class="label">Normalized Tables</div></div>
          <div class="info-card"><div class="value">~103K</div><div class="label">Records Loaded</div></div>
          <div class="info-card"><div class="value">7</div><div class="label">ETL Steps</div></div>
        </div>
      </div>

      <!-- LIVE SQL RUNNER -->
      <div class="content-section fade-in">
        <h2>Try It Yourself &mdash; Live SQL Playground</h2>
        <p>The database is loaded in your browser with sample data. Write any SQL query and run it instantly:</p>

        <div class="sql-runner">
          <div class="sql-runner-header">
            <h4>&#9654; SQL Playground</h4>
            <span class="sql-runner-status">Loading...</span>
          </div>
          <div class="sql-presets">
            <button class="sql-preset-btn" data-query="SELECT * FROM customers LIMIT 10;">Show Customers</button>
            <button class="sql-preset-btn" data-query="SELECT p.name, p.brand, p.color, p.cost, p.price, ps.subcategory_name, pc.category_name FROM products p JOIN product_subcategories ps ON p.subcategory_id = ps.subcategory_id JOIN product_categories pc ON ps.category_id = pc.category_id ORDER BY p.price DESC;">Products by Price</button>
            <button class="sql-preset-btn" data-query="SELECT pc.category_name, COUNT(DISTINCT o.order_number) AS orders, SUM(p.price * li.quantity) AS revenue, ROUND(AVG(p.price * li.quantity), 2) AS avg_item_value FROM order_line_items li JOIN orders o ON li.order_number = o.order_number JOIN products p ON li.product_id = p.product_id JOIN product_subcategories ps ON p.subcategory_id = ps.subcategory_id JOIN product_categories pc ON ps.category_id = pc.category_id GROUP BY pc.category_name ORDER BY revenue DESC;">Revenue by Category</button>
            <button class="sql-preset-btn" data-query="SELECT c.customer_id, c.name, c.country, COUNT(DISTINCT o.order_number) AS total_orders, ROUND(SUM(p.price * li.quantity), 2) AS lifetime_value FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_line_items li ON o.order_number = li.order_number JOIN products p ON li.product_id = p.product_id GROUP BY c.customer_id, c.name, c.country ORDER BY lifetime_value DESC LIMIT 10;">Top Customers</button>
            <button class="sql-preset-btn" data-query="SELECT s.store_id, s.country, s.state, s.sq_meters, COUNT(DISTINCT o.order_number) AS orders, ROUND(SUM(p.price * li.quantity), 2) AS revenue FROM stores s JOIN orders o ON s.store_id = o.store_id JOIN order_line_items li ON o.order_number = li.order_number JOIN products p ON li.product_id = p.product_id GROUP BY s.store_id, s.country, s.state, s.sq_meters ORDER BY revenue DESC;">Store Performance</button>
            <button class="sql-preset-btn" data-query="SELECT substr(o.order_date, 1, 7) AS month, COUNT(DISTINCT o.order_number) AS orders, ROUND(SUM(p.price * li.quantity), 2) AS revenue FROM orders o JOIN order_line_items li ON o.order_number = li.order_number JOIN products p ON li.product_id = p.product_id GROUP BY month ORDER BY month;">Monthly Trends</button>
          </div>
          <div class="sql-editor">
            <textarea placeholder="Write your SQL query here... (Ctrl+Enter to run)">SELECT * FROM orders LIMIT 5;</textarea>
          </div>
          <div class="sql-actions">
            <button class="sql-run-btn">&#9654; Run Query</button>
            <button class="sql-clear-btn">Clear</button>
          </div>
          <div class="sql-result" style="display:none"></div>
        </div>
      </div>

      <!-- ETL Pipeline -->
      <div class="content-section fade-in">
        <h2>ETL Pipeline Architecture</h2>
        <div class="process-steps">
          <div class="step"><div class="step-number">1</div><h4>Connect</h4><p>Establish MySQL connection on port 3307.</p></div>
          <div class="step"><div class="step-number">2</div><h4>Create Database</h4><p>Create sales_analysis_db if it doesn't exist.</p></div>
          <div class="step"><div class="step-number">3</div><h4>Create Tables</h4><p>Build 7 normalized tables with PKs, FKs, indexes.</p></div>
          <div class="step"><div class="step-number">4</div><h4>Extract &amp; Transform</h4><p>Load Excel (62K rows) with Pandas, extract 7 entities.</p></div>
          <div class="step"><div class="step-number">5</div><h4>Load Data</h4><p>Insert in FK order: categories first, then products, orders, line items. Batch insert for 62K rows.</p></div>
          <div class="step"><div class="step-number">6</div><h4>Verify</h4><p>Count queries on all 7 tables to confirm success.</p></div>
          <div class="step"><div class="step-number">7</div><h4>Sample Queries</h4><p>Revenue by category, store analysis, customer lifetime value.</p></div>
        </div>
      </div>

      <!-- Code Highlights -->
      <div class="content-section fade-in">
        <h2>Code Highlights</h2>

        <h3>Product Hierarchy Extraction</h3>
        <div class="code-block">
          <div class="code-header"><span class="code-lang">Python</span><div class="code-dots"><span></span><span></span><span></span></div></div>
          <div class="code-body"><pre><span class="kw">def</span> <span class="fn">extract_product_categories</span>(<span class="par">df</span>):
    <span class="str">"""Extract unique product categories"""</span>
    cats = df[[<span class="str">'ProductCategoryID'</span>, <span class="str">'ProductCategory'</span>]].drop_duplicates()
    cats.columns = [<span class="str">'category_id'</span>, <span class="str">'category_name'</span>]
    <span class="kw">return</span> cats

<span class="kw">def</span> <span class="fn">extract_product_subcategories</span>(<span class="par">df</span>):
    <span class="str">"""Extract subcategories with FK to category"""</span>
    subcats = df[[<span class="str">'ProductSubcategoryID'</span>, <span class="str">'ProductCategoryID'</span>,
                   <span class="str">'ProductSubcategory'</span>]].drop_duplicates(
                       subset=[<span class="str">'ProductSubcategoryID'</span>])
    <span class="kw">return</span> subcats

<span class="kw">def</span> <span class="fn">extract_products</span>(<span class="par">df</span>):
    <span class="str">"""Extract 2,492 unique products"""</span>
    cols = [<span class="str">'ProductID'</span>, <span class="str">'ProductSubcategoryID'</span>, <span class="str">'ProductName'</span>,
            <span class="str">'ProductBrand'</span>, <span class="str">'ProductColor'</span>, <span class="str">'ProductCost'</span>, <span class="str">'ProductPrice'</span>]
    products = df[cols].drop_duplicates(subset=[<span class="str">'ProductID'</span>])
    <span class="kw">return</span> products</pre></div>
        </div>

        <h3>Batch Loading for Large Tables</h3>
        <div class="code-block">
          <div class="code-header"><span class="code-lang">Python</span><div class="code-dots"><span></span><span></span><span></span></div></div>
          <div class="code-body"><pre><span class="kw">def</span> <span class="fn">insert_order_line_items</span>(<span class="par">connection</span>, <span class="par">items</span>):
    <span class="str">"""Batch insert 62,884 line items"""</span>
    query = <span class="str">"""INSERT IGNORE INTO order_line_items
        (transaction_id, order_number, line_item, product_id, quantity)
        VALUES (%s, %s, %s, %s, %s)"""</span>

    BATCH_SIZE = <span class="num">5000</span>
    <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="num">0</span>, <span class="fn">len</span>(data), BATCH_SIZE):
        batch = data[i:i + BATCH_SIZE]
        cursor.executemany(query, batch)
        connection.commit()
        <span class="fn">print</span>(<span class="str">f"Batch {i//BATCH_SIZE + 1}: inserted {cursor.rowcount} rows"</span>)</pre></div>
        </div>
      </div>

      <!-- Full Source Code -->
      <div class="content-section fade-in">
        <h2>Full Source Code</h2>
        <div class="code-viewer">
          <div class="code-viewer-header">
            <div class="code-viewer-title">
              <span class="file-icon">&#128196;</span>
              <span class="file-name">retail_sales_load.py</span>
              <span class="file-size">&mdash; ~600 lines</span>
            </div>
            <div class="code-viewer-toggle">View Source <span class="arrow">&#9660;</span></div>
          </div>
          <div class="code-viewer-body">
            <pre><span class="line-num">  1</span><span class="str">"""</span>
<span class="line-num">  2</span><span class="str">Retail Sales Data Normalization and MySQL Database Loader</span>
<span class="line-num">  3</span><span class="str">Transforms denormalized retail sales data into normalized DB</span>
<span class="line-num">  4</span><span class="str">"""</span>
<span class="line-num">  5</span>
<span class="line-num">  6</span><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="line-num">  7</span><span class="kw">import</span> mysql.connector
<span class="line-num">  8</span>
<span class="line-num">  9</span>DB_CONFIG = {
<span class="line-num"> 10</span>    <span class="str">'host'</span>: <span class="str">'localhost'</span>,
<span class="line-num"> 11</span>    <span class="str">'port'</span>: <span class="num">3307</span>,
<span class="line-num"> 12</span>    <span class="str">'database'</span>: <span class="str">'sales_analysis_db'</span>
<span class="line-num"> 13</span>}
<span class="line-num"> 14</span>
<span class="line-num"> 15</span><span class="cmt"># 7 tables: customers, stores, product_categories,</span>
<span class="line-num"> 16</span><span class="cmt"># product_subcategories, products, orders, order_line_items</span>
<span class="line-num"> 17</span><span class="cmt"># Functions: create_connection, create_database,</span>
<span class="line-num"> 18</span><span class="cmt"># create_tables, extract_*, insert_*, verify_data</span>
<span class="line-num"> 19</span><span class="cmt"># (See full download for complete implementation)</span></pre>
          </div>
        </div>
        <p style="margin-top:1rem;font-size:0.9rem">
          <a href="src/retail_sales_load.py" download>&#11015; Download the full retail_sales_load.py</a>
        </p>
      </div>

      <!-- Tables -->
      <div class="content-section fade-in">
        <h2>Normalized Tables</h2>
        <table class="styled-table">
          <thead><tr><th>Table</th><th>Records</th><th>Primary Key</th><th>Purpose</th></tr></thead>
          <tbody>
            <tr><td>customers</td><td>11,887</td><td>customer_id</td><td>Customer demographics and location</td></tr>
            <tr><td>stores</td><td>58</td><td>store_id</td><td>Store locations with size and open date</td></tr>
            <tr><td>product_categories</td><td>8</td><td>category_id</td><td>Top-level product categories</td></tr>
            <tr><td>product_subcategories</td><td>32</td><td>subcategory_id</td><td>Subcategories linked to categories</td></tr>
            <tr><td>products</td><td>2,492</td><td>product_id</td><td>Product catalog with cost and price</td></tr>
            <tr><td>orders</td><td>26,326</td><td>order_number</td><td>Order headers with dates</td></tr>
            <tr><td>order_line_items</td><td>62,884</td><td>transaction_id</td><td>Line items with product and quantity</td></tr>
          </tbody>
        </table>
      </div>

      <!-- Key Features -->
      <div class="content-section fade-in">
        <h2>Key Features</h2>
        <div class="highlight-box">
          <h4>Robust Data Handling</h4>
          <ul>
            <li>NaN/NULL handling for nullable dates and international zip codes</li>
            <li>Date conversion from Excel datetime to MySQL DATE</li>
            <li>INSERT IGNORE for graceful duplicate handling</li>
            <li>FK constraint-aware insertion order (7 tables)</li>
          </ul>
        </div>
        <div class="highlight-box">
          <h4>Performance &amp; Scale</h4>
          <ul>
            <li>Batch insertion (5,000 rows/batch) for 62K line items</li>
            <li>3-level product hierarchy: categories &rarr; subcategories &rarr; products</li>
            <li>Indexes on frequently queried columns (brand, price, country)</li>
            <li>Multi-country dataset: US, Canada, UK, Germany, France, Australia</li>
          </ul>
        </div>
      </div>

    </div>
  </div>

  <div class="joke-section">
    <div class="joke-section-header">Random Joke</div>
    <div id="joke-content"><span class="joke-loading">Loading joke...</span></div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="footer-social">
        <a href="mailto:anuragmesh@gmail.com">&#9993; Email</a>
        <a href="https://tiny.cc/c9zx001" target="_blank" rel="noopener">LinkedIn</a>
        <a href="https://github.com/charon9999/data-analyst-project" target="_blank" rel="noopener">GitHub</a>
      </div>
      <div class="footer-links">
        <a href="index.html">Home</a><a href="experience.html">Experience</a>
        <a href="index.html#projects">Projects</a>
        <a href="assets/resume/Anurag_Meshram_Resume.pdf" download>Resume</a>
      </div>
      <p>&copy; 2026 Anurag Meshram. Built with passion for data.</p>
    </div>
  </footer>

  <script src="assets/js/main.js"></script>
  <script src="assets/js/sql-runner-retail.js"></script>
  <script src="assets/js/joke.js"></script>
</body>
</html>
